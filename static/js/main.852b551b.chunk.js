(this.webpackJsonpreversi=this.webpackJsonpreversi||[]).push([[0],{26:function(e,t,a){},46:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var r=a(8),i=a.n(r),s=a(39),n=a.n(s),c=(a(46),a(26),a(0)),o=a.n(c),u=a(3),l=a(11),h=a(40),b=a.n(h),d=a(5),f=a(1),j=a(2);function v(e){return new Promise((function(t){return setTimeout(t,e)}))}var p,y=function(){function e(){Object(f.a)(this,e),this.board=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,2,1,0,0,0],[0,0,0,1,2,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],this.subscribers=[],this.numBlack=2,this.numWhite=2,this.nextPlayer=2,this.switchStatus=!0,this.mode="computer",this.legal=!0,this.isBusy=!1,this.weight=[[500,-25,10,5,5,10,-25,500],[-25,-45,1,1,1,1,-45,-25],[10,1,3,2,2,3,1,10],[5,1,2,1,1,2,1,5],[5,1,2,1,1,2,1,5],[10,1,3,2,2,3,1,10],[-25,-45,1,1,1,1,-45,-25],[500,-25,10,5,5,10,-25,500]],this.showLegalMoves()}return Object(j.a)(e,[{key:"getComputerMove",value:function(){for(var e,t,a=-1/0,r=0;r<8;r++)for(var i=0;i<8;i++)if(this.isValidMove(r,i,this.nextPlayer)){var s=this.weight[r][i];s>a&&(e=r,t=i,a=s)}return{computer_i:e,computer_j:t}}},{key:"setMode",value:function(e){this.mode=e}},{key:"getLegalStatus",value:function(){return this.legal}},{key:"setSwitchStatus",value:function(e){this.switchStatus=e}},{key:"setLegal",value:function(e){this.legal=e}},{key:"resetBoard",value:function(){this.board=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,2,1,0,0,0],[0,0,0,1,2,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],this.numBlack=2,this.numWhite=2,this.nextPlayer=2,this.legal=!0,this.isBusy=!1,this.switchStatus?this.showLegalMoves():this.updataSubscribers()}},{key:"subscribeToUpdates",value:function(e){this.subscribers.push(e)}},{key:"updataSubscribers",value:function(){var e,t=Object(d.a)(this.subscribers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(a){t.e(a)}finally{t.f()}}},{key:"getRowColByKey",value:function(e){var t=e%10-1;return{i:parseInt(e%100/10)-1,j:t}}},{key:"placePiece",value:function(e,t,a){this.board[e][t]=a,this.setLegal(!0)}},{key:"updateNextPlayer",value:function(){var e=2===this.nextPlayer?1:2;this.nextPlayer=this.hasLegalMove(e)?e:this.nextPlayer}},{key:"addPiece",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var a,r,i,s,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isBusy){e.next=2;break}return e.abrupt("return");case 2:if(this.isBusy=!0,this.clearLegalMoves(),a=this.getRowColByKey(t),r=a.i,i=a.j,this.isValidMove(r,i,this.nextPlayer)){e.next=11;break}return this.setLegal(!1),this.switchStatus&&this.showLegalMoves(),this.updataSubscribers(),this.isBusy=!1,e.abrupt("return");case 11:return this.placePiece(r,i,this.nextPlayer),this.updateNumPieces(),this.updataSubscribers(),e.next=16,v(500);case 16:if(this.flipPieces(r,i),this.updateNumPieces(),this.updateNextPlayer(),this.updataSubscribers(),this.checkWin()){e.next=37;break}if("computer"!==this.mode){e.next=37;break}this.clearLegalMoves();case 23:if(1!==this.nextPlayer){e.next=37;break}return s=this.getComputerMove(),n=s.computer_i,c=s.computer_j,e.next=27,v(1e3);case 27:return this.placePiece(n,c,this.nextPlayer),this.updateNumPieces(),this.updataSubscribers(),e.next=32,v(500);case 32:this.flipPieces(n,c),this.updateNumPieces(),this.updateNextPlayer(),e.next=23;break;case 37:this.switchStatus?this.showLegalMoves():this.updataSubscribers(),this.isBusy=!1;case 39:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showLegalMoves",value:function(){for(var e=0;e<8;e++)for(var t=0;t<8;t++)this.isValidMove(e,t,this.nextPlayer)&&(this.board[e][t]=.5);this.updataSubscribers()}},{key:"clearLegalMoves",value:function(){for(var e=0;e<8;e++)for(var t=0;t<8;t++).5===this.board[e][t]&&(this.board[e][t]=0);this.updataSubscribers()}},{key:"getWinner",value:function(){return this.numBlack>this.numWhite?2:1}},{key:"checkWin",value:function(){return this.hasLegalMove(1)||this.hasLegalMove(2)?0:(this.isBusy=!0,this.getWinner())}},{key:"getNextPlayer",value:function(){return this.nextPlayer}},{key:"getBoardArray",value:function(){return this.board}},{key:"updateNumPieces",value:function(){for(var e=0,t=0,a=0;a<8;a++)for(var r=0;r<8;r++)2===this.board[a][r]?e++:1===this.board[a][r]&&t++;this.numBlack=e,this.numWhite=t}},{key:"getNumPieces",value:function(e){return 2===e?this.numBlack:this.numWhite}},{key:"hasLegalMove",value:function(e){for(var t=0;t<8;t++)for(var a=0;a<8;a++)if(this.isValidMove(t,a,e))return!0;return!1}},{key:"checkVertically",value:function(e,t,a,r){for(var i=e+1;i<t;i++)if(0===this.board[i][a]||.5===this.board[i][a]||this.board[i][a]===r)return!1;return!0}},{key:"checkHorizontally",value:function(e,t,a,r){for(var i=e+1;i<t;i++)if(0===this.board[a][i]||.5===this.board[a][i]||this.board[a][i]===r)return!1;return!0}},{key:"checkDiagonallyBottomRight",value:function(e,t,a,r){for(var i=e+1;i<t;i++){var s=a+i-e;if(0===this.board[i][s]||.5===this.board[i][s]||this.board[i][s]===r)return!1}return!0}},{key:"checkDiagonallyBottomLeft",value:function(e,t,a,r){for(var i=e+1;i<t;i++){var s=a-i+e;if(0===this.board[i][s]||.5===this.board[i][s]||this.board[i][s]===r)return!1}return!0}},{key:"flipVertically",value:function(e,t,a){for(var r=e+1;r<t;r++)this.board[r][a]=this.board[e][a]}},{key:"flipHorizontally",value:function(e,t,a){for(var r=e+1;r<t;r++)this.board[a][r]=this.board[a][e]}},{key:"flipDiagonallyBottomRight",value:function(e,t,a){for(var r=e+1;r<t;r++){var i=a+r-e;this.board[r][i]=this.board[e][a]}}},{key:"flipDiagonallyBottomLeft",value:function(e,t,a){for(var r=e+1;r<t;r++){var i=a-r+e;this.board[r][i]=this.board[e][a]}}},{key:"isValidMove",value:function(e,t,a){if(1===this.board[e][t]||2===this.board[e][t])return!1;for(var r=e-2;r>=0;r--)if(this.board[r][t]===a&&this.checkVertically(r,e,t,a))return!0;for(var i=e+2;i<8;i++)if(this.board[i][t]===a&&this.checkVertically(e,i,t,a))return!0;for(var s=t-2;s>=0;s--)if(this.board[e][s]===a&&this.checkHorizontally(s,t,e,a))return!0;for(var n=t+2;n<8;n++)if(this.board[e][n]===a&&this.checkHorizontally(t,n,e,a))return!0;for(var c=e-2;c>=0;c--){var o=t-e+c;if(o>=0&&this.board[c][o]===a&&this.checkDiagonallyBottomRight(c,e,o,a))return!0}for(var u=e-2;u>=0;u--){var l=t+e-u;if(l<8&&this.board[u][l]===a&&this.checkDiagonallyBottomLeft(u,e,l,a))return!0}for(var h=e+2;h<8;h++){var b=t-h+e;if(b>=0&&this.board[h][b]===a&&this.checkDiagonallyBottomLeft(e,h,t,a))return!0}for(var d=e+2;d<8;d++){var f=t+d-e;if(f<8&&this.board[d][f]===a&&this.checkDiagonallyBottomRight(e,d,t,a))return!0}return!1}},{key:"flipPieces",value:function(e,t){for(var a=this.board[e][t],r=e-1;r>=0;r--)this.board[r][t]===a&&this.checkVertically(r,e,t,a)&&this.flipVertically(r,e,t);for(var i=e+1;i<8;i++)this.board[i][t]===a&&this.checkVertically(e,i,t,a)&&this.flipVertically(e,i,t);for(var s=t-1;s>=0;s--)this.board[e][s]===a&&this.checkHorizontally(s,t,e,a)&&this.flipHorizontally(s,t,e);for(var n=t+1;n<8;n++)this.board[e][n]===a&&this.checkHorizontally(t,n,e,a)&&this.flipHorizontally(t,n,e);for(var c=e-1;c>=0;c--){var o=t-e+c;o>=0&&this.board[c][o]===a&&this.checkDiagonallyBottomRight(c,e,o,a)&&this.flipDiagonallyBottomRight(c,e,o)}for(var u=e-1;u>=0;u--){var l=t+e-u;l<8&&this.board[u][l]===a&&this.checkDiagonallyBottomLeft(u,e,l,a)&&this.flipDiagonallyBottomLeft(u,e,l)}for(var h=e+1;h<8;h++){var b=t-h+e;b>=0&&this.board[h][b]===a&&this.checkDiagonallyBottomLeft(e,h,t,a)&&this.flipDiagonallyBottomLeft(e,h,t)}for(var d=e+1;d<8;d++){var f=t+d-e;f<8&&this.board[d][f]===a&&this.checkDiagonallyBottomRight(e,d,t,a)&&this.flipDiagonallyBottomRight(e,d,t)}}}]),e}();var m,x=a(35),k=a(23);0===Object(x.a)().length&&(m=Object(x.b)({apiKey:"AIzaSyA0SVlli6rx1wYyXKiYXH0MgwiVWHfQk-c",authDomain:"edu-umich-zzhiyuan-reversi.firebaseapp.com",projectId:"edu-umich-zzhiyuan-reversi",storageBucket:"edu-umich-zzhiyuan-reversi.appspot.com",messagingSenderId:"868073070089",appId:"1:868073070089:web:cd65df734b7834b1c3a2d8"}));var O,g=Object(k.d)(m,{useFetchStreams:!1}),S=function(){function e(){var t=this;Object(f.a)(this,e),this.asyncInit=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadLeaders();case 2:case"end":return e.stop()}}),e)}))),this.loadLeaders=Object(u.a)(o.a.mark((function e(){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(k.f)(t.collRef,Object(k.e)(10)),e.next=3,Object(k.c)(a);case 3:if(!(r=e.sent).empty){e.next=6;break}return e.abrupt("return");case 6:r.docs.forEach((function(e){var a=e.id,r=e.data();r.key=a,t.leaders.push(r)})),t.updateSubscribers();case 8:case"end":return e.stop()}}),e)}))),this.addItem=function(){var e=Object(u.a)(o.a.mark((function e(a,r){var i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={name:a,score:r},e.next=3,Object(k.a)(t.collRef,i);case 3:s=e.sent,i.key=s.id,t.leaders.push(i),t.updateSubscribers();case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.collRef=Object(k.b)(g,"leaderboard"),this.leaders=[],this.subscribers=[],this.asyncInit()}return Object(j.a)(e,[{key:"subscribeToUpdates",value:function(e){this.subscribers.push(e)}},{key:"updateSubscribers",value:function(){var e,t=Object(d.a)(this.subscribers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(a){t.e(a)}finally{t.f()}}},{key:"getLeadersCopy",value:function(){return this.leaders.sort((function(e,t){return t.score-e.score})),Array.from(this.leaders)}}]),e}();function w(){return O||(O=new S),O}var N=a(4);var B=function(e){var t=e.number,a=e.piece,r=e.onPress;return Object(N.jsx)("div",{className:"tile "+(t%2===1?"tile-black":"tile-white"),onClick:r,children:Object(N.jsx)("div",{className:0===a?"":2===a?"piece piece-black":1===a?"piece piece-white":"potential "+(t%2===1?"potential-black":"potential-white")})})},P=a(56),L=a(57);a(38);var M=function(e){var t=e.mode,a=e.winner,i=e.score,s=e.onClose,n=e.onStart,c=e.onSubmit,o=Object(r.useState)(""),u=Object(l.a)(o,2),h=u[0],b=u[1],d=Object(r.useState)(!1),f=Object(l.a)(d,2),j=f[0],v=f[1];return Object(N.jsx)("div",{className:"modal-background",children:Object(N.jsxs)("div",{className:"content-box",children:[Object(N.jsx)("span",{className:"close",onClick:s,children:"\xd7"}),"multiplayer"===t?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("p",{className:"congrats",children:[2===a?"Black":"White"," won! "]}),Object(N.jsx)("button",{type:"button",onClick:n,className:"btn btn-outline-dark",children:"Start a new game! "})]}):Object(N.jsx)(N.Fragment,{children:2===a?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{className:"congrats special-congrats",children:"You won! "}),Object(N.jsxs)(P.a,{id:"submit-name",children:[Object(N.jsx)(L.a,{type:"text",placeholder:"Enter your name",value:h,maxLength:15,onChange:function(e){b(e.target.value)}}),Object(N.jsx)("button",{disabled:j,type:"button",className:"btn btn-outline-dark",onClick:function(){c(h,i),v(!0)},children:"Submit"})]}),Object(N.jsx)("button",{type:"button",onClick:n,className:"btn btn-outline-dark",children:"Start a new game! "})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{className:"congrats",children:"Good game! "}),Object(N.jsx)("button",{type:"button",onClick:n,className:"btn btn-outline-dark",children:"Start a new game! "})]})})]})})};var C=function(){var e=(p||(p=new y),p),t=w(),a=e.getBoardArray(),i=Object(r.useState)(t.getLeadersCopy()),s=Object(l.a)(i,2),n=(s[0],s[1]),c=Object(r.useState)(!1),h=Object(l.a)(c,2),d=h[0],f=h[1],j=Object(r.useState)("Black"),v=Object(l.a)(j,2),m=v[0],x=v[1],k=Object(r.useState)(2),O=Object(l.a)(k,2),g=O[0],S=O[1],P=Object(r.useState)(2),L=Object(l.a)(P,2),C=L[0],D=L[1],R=Object(r.useState)(!0),V=Object(l.a)(R,2),z=V[0],I=V[1],W=Object(r.useState)(!0),F=Object(l.a)(W,2),H=F[0],T=F[1],E=Object(r.useState)("computer"),A=Object(l.a)(E,2),U=A[0],K=A[1];function Y(t){for(var a=[],r=function(r){for(var i=function(i){a.push(Object(N.jsx)(B,{number:r+i+2,piece:t[r][i],onPress:Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.addPiece(10*(r+1)+(i+1));case 2:e.checkWin()&&f(!0);case 3:case"end":return t.stop()}}),t)})))},10*(r+1)+(i+1)))},s=0;s<8;s++)i(s)},i=0;i<8;i++)r(i);return a}var _=Object(r.useState)(Y(a)),G=Object(l.a)(_,2),J=G[0],X=G[1];function q(){f(!1)}function Q(){e.resetBoard(z),e.setMode("computer"),K("computer")}function Z(){e.resetBoard(z),e.setMode("multiplayer"),K("multiplayer")}return Object(r.useEffect)((function(){e.subscribeToUpdates((function(){X(Y(e.getBoardArray())),S(e.getNumPieces(2)),D(e.getNumPieces(1)),T(e.getLegalStatus()),2===e.getNextPlayer()?x("Black"):1===e.getNextPlayer()&&x("White")})),t.subscribeToUpdates((function(){n(t.getLeadersCopy())}))}),[]),Object(N.jsxs)("div",{id:"chessboard",children:[Object(N.jsx)("h1",{children:"REVERSI"}),Object(N.jsx)("div",{className:"control",children:Object(N.jsxs)("div",{className:"menu",children:[Object(N.jsx)("button",{type:"button",className:"btn btn-outline-dark",onClick:Q,children:Object(N.jsx)("span",{className:"btn-text",children:"New Game"})}),Object(N.jsx)("button",{type:"button",className:"btn btn-outline-dark",onClick:Z,children:Object(N.jsx)("span",{className:"btn-text",children:"Multiplayer"})}),Object(N.jsxs)("div",{className:"switch",children:[Object(N.jsx)("div",{children:Object(N.jsx)("span",{className:"btn-text",children:"Show legal moves"})}),Object(N.jsx)(b.a,{onChange:function(t){I(t),e.setSwitchStatus(t),t?e.showLegalMoves():e.clearLegalMoves()},checked:z,onColor:"#292C6D",boxShadow:"0 0 0.3em #292C6D",uncheckedIcon:!1,checkedIcon:!1,activeBoxShadow:null})]})]})}),Object(N.jsxs)("div",{id:"score-board",children:[Object(N.jsx)("div",{className:"piece piece-black",children:g}),Object(N.jsxs)("div",{className:"info-box",children:[Object(N.jsx)("p",{id:"turn",children:"multiplayer"===U?"".concat(m,"'s turn"):"Black"===m?"Your turn":"Not your turn"}),Object(N.jsx)("p",{id:"warning",children:H?"":"Sorry, this square is not a valid move."})]}),Object(N.jsx)("div",{className:"piece piece-white",children:C})]}),d?Object(N.jsx)(M,{mode:U,winner:e.getWinner(),score:Math.max(g,C),onClose:q,onSubmit:function(e,a){return t.addItem(e,a)},onStart:function(){"computer"===U?Q():"multiplayer"===U&&Z(),q()}}):null,Object(N.jsx)("div",{id:"board-container",children:Object(N.jsx)("div",{id:"board",children:J})})]})};function D(e){var t=e.name,a=e.score;return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{className:"player-name",children:Object(N.jsx)("span",{className:"player-name-span",children:t})}),Object(N.jsx)("td",{children:a})]})}var R=function(){var e=w(),t=Object(r.useState)(e.getLeadersCopy()),a=Object(l.a)(t,2),i=a[0],s=a[1];return Object(r.useEffect)((function(){e.subscribeToUpdates((function(){s(e.getLeadersCopy())}))}),[]),Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{className:"leaderboard",children:[Object(N.jsx)("h3",{children:"Leaderboard"}),Object(N.jsxs)("table",{children:[Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{children:"Name"}),Object(N.jsx)("th",{children:"Score"})]}),i.map((function(e){return Object(N.jsx)(D,{name:e.name,score:e.score},e.key)}))]})]})})};var V=function(){return document.title="Reversi | SI 579 Final Project",Object(N.jsx)("main",{children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)("div",{className:"hidden",children:Object(N.jsx)(R,{})}),Object(N.jsx)(C,{}),Object(N.jsx)(R,{})]})})},z=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,58)).then((function(t){var a=t.getCLS,r=t.getFID,i=t.getFCP,s=t.getLCP,n=t.getTTFB;a(e),r(e),i(e),s(e),n(e)}))};n.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(V,{})}),document.getElementById("root")),z()}},[[54,1,2]]]);
//# sourceMappingURL=main.852b551b.chunk.js.map